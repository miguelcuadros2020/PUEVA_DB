<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ejemplo de Uso - JSON to Table</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <style>
        body { padding: 20px; background-color: #f8f9fa; }
        .container { max-width: 1200px; }
        .card { margin-bottom: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="card-header bg-primary text-white">
                <h3>Ejemplo de Uso Local</h3>
            </div>
            <div class="card-body">
                <p>Este ejemplo muestra cómo usar la función <code>convertJsonToTable</code> localmente en tu código.</p>
                
                <button class="btn btn-success" onclick="mostrarTablaUsuarios()">Mostrar Tabla de Usuarios</button>
                <button class="btn btn-info" onclick="mostrarTablaProductos()">Mostrar Tabla de Productos</button>
                <button class="btn btn-warning" onclick="mostrarTablaArticulos()">Mostrar Tabla de Artículos</button>
            </div>
        </div>

        <div class="card">
            <div class="card-header bg-success text-white">
                <h4>Resultado</h4>
            </div>
            <div class="card-body">
                <div id="resultado">
                    <p class="text-muted">Haz clic en un botón para ver la tabla generada</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Función convertJsonToTable (copia esta función a tu proyecto)
        function convertJsonToTable(jsonData) {
            try {
                // Si es un array, usarlo directamente
                let data = jsonData;
                if (Array.isArray(jsonData)) {
                    data = jsonData;
                } else {
                    // Si es un objeto, buscar la primera propiedad que sea un array
                    for (const key in jsonData) {
                        if (Array.isArray(jsonData[key])) {
                            data = jsonData[key];
                            break;
                        }
                    }
                }

                // Si no hay datos, mostrar mensaje
                if (!data || data.length === 0) {
                    return '<div class="alert alert-info">No hay datos para mostrar</div>';
                }

                // Obtener las columnas del primer elemento
                const columns = Object.keys(data[0]);
                
                // Crear encabezados
                let headers = '';
                columns.forEach(column => {
                    headers += `<th class="table-primary text-white">${column}</th>`;
                });

                // Crear filas
                let rows = '';
                data.forEach((item, index) => {
                    let cells = '';
                    columns.forEach(column => {
                        const value = item[column];
                        let cellContent = '';
                        
                        // Formatear el valor según su tipo
                        if (value === null || value === undefined) {
                            cellContent = '<span class="text-muted">-</span>';
                        } else if (typeof value === 'boolean') {
                            const badgeClass = value ? 'success' : 'secondary';
                            const text = value ? 'Sí' : 'No';
                            cellContent = `<span class="badge bg-${badgeClass}">${text}</span>`;
                        } else if (typeof value === 'number') {
                            cellContent = `<span class="text-primary">${value}</span>`;
                        } else if (typeof value === 'string') {
                            // Si parece ser un email
                            if (value.includes('@') && value.includes('.')) {
                                cellContent = `<a href="mailto:${value}" class="text-primary">${value}</a>`;
                            }
                            // Si parece ser una URL
                            else if (value.startsWith('http')) {
                                cellContent = `<a href="${value}" target="_blank" class="text-info">${value}</a>`;
                            }
                            // Texto normal
                            else {
                                cellContent = value;
                            }
                        } else if (Array.isArray(value)) {
                            cellContent = `<span class="badge bg-secondary">${value.length} items</span>`;
                        } else {
                            cellContent = JSON.stringify(value);
                        }
                        
                        cells += `<td>${cellContent}</td>`;
                    });
                    
                    // Alternar colores de filas
                    const rowClass = index % 2 === 0 ? 'table-light' : 'table-white';
                    rows += `<tr class="${rowClass}">${cells}</tr>`;
                });

                // Crear la tabla completa
                const table = `
                    <div class="table-responsive">
                        <table class="table table-hover table-striped">
                            <thead>
                                <tr>
                                    ${headers}
                                </tr>
                            </thead>
                            <tbody>
                                ${rows}
                            </tbody>
                        </table>
                    </div>
                    <div class="mt-3 text-muted">
                        <small>Total: ${data.length} registros, ${columns.length} columnas</small>
                    </div>
                `;

                return table;

            } catch (error) {
                return `<div class="alert alert-danger">Error: ${error.message}</div>`;
            }
        }

        // Datos de ejemplo
        const usuarios = [
            {"id": 1, "nombre": "Juan Pérez", "email": "juan@email.com", "edad": 25, "activo": true},
            {"id": 2, "nombre": "Ana García", "email": "ana@email.com", "edad": 30, "activo": false},
            {"id": 3, "nombre": "Carlos López", "email": "carlos@email.com", "edad": 28, "activo": true}
        ];

        const productos = {
            "productos": [
                {"codigo": "P001", "nombre": "Laptop", "precio": 999.99, "categoria": "Electrónicos", "stock": 10},
                {"codigo": "P002", "nombre": "Mouse", "precio": 29.99, "categoria": "Accesorios", "stock": 50},
                {"codigo": "P003", "nombre": "Monitor", "precio": 299.99, "categoria": "Monitores", "stock": 5}
            ]
        };

        const articulos = [
            {"id": 1, "titulo": "Artículo 1", "autor": "Autor 1", "fecha": "2024-01-15"},
            {"id": 2, "titulo": "Artículo 2", "autor": "Autor 2", "fecha": "2024-01-16"},
            {"id": 3, "titulo": "Artículo 3", "autor": "Autor 3", "fecha": "2024-01-17"}
        ];

        // Funciones para mostrar las tablas
        function mostrarTablaUsuarios() {
            const html = convertJsonToTable(usuarios);
            document.getElementById('resultado').innerHTML = html;
        }

        function mostrarTablaProductos() {
            const html = convertJsonToTable(productos);
            document.getElementById('resultado').innerHTML = html;
        }

        function mostrarTablaArticulos() {
            const html = convertJsonToTable(articulos);
            document.getElementById('resultado').innerHTML = html;
        }
    </script>
</body>
</html>
